(function(c){window["BIONE"]={};BIONE.cookies=(function(){var e=function(){};e.prototype.get=function(f){var h="";var g=f+"=";if(document.cookie.length>0){offset=document.cookie.indexOf(g);if(offset!=-1){offset+=g.length;end=document.cookie.indexOf(";",offset);if(end==-1){end=document.cookie.length;}h=decodeURIComponent(document.cookie.substring(offset,end));}}return h;};e.prototype.set=function(j,h,i){var f="";var g=1;if(i!=null){g=i;}f=new Date((new Date()).getTime()+g*86400000);f="; expires="+f.toGMTString();document.cookie=j+"="+encodeURIComponent(h)+";path=/"+f;};e.prototype.remvoe=function(g){var f="";f=new Date((new Date()).getTime()-1);f="; expires="+f.toGMTString();document.cookie=g+"="+escape("")+";path=/"+f;};return new e();})();BIONE.tip=function(e){if(BIONE.wintip){BIONE.wintip.set("content",e);BIONE.wintip.show();}else{BIONE.wintip=top.$.ligerDialog.tip({content:e});}setTimeout(function(){BIONE.wintip.hide();},4000);};BIONE.prevLoadImage=function(f,g){for(var e in g){c("<img />").attr("src",f+g[e]);}};BIONE.showLoading=function(e){e=e||"正在加载中...";c("body").append("<div class='jloading'>"+e+"</div>");c.ligerui.win.mask();};BIONE.hideLoading=function(e){c("body > div.jloading").remove();c.ligerui.win.unmask({id:new Date().getTime()});};BIONE.showSuccess=function(e,f){if(typeof(e)=="function"||arguments.length==0){f=e;e="操作成功!";}c.ligerDialog.success(e,"提示信息",f);};BIONE.showError=function(e,f){if(typeof(e)=="function"||arguments.length==0){f=e;e="操作失败!";}c.ligerDialog.error(e,"提示信息",f);};BIONE.prevDialogImage=function(e){e=e||"";BIONE.prevLoadImage(e+"lib/ligerUI/skins/Aqua/images/win/",["dialog-icons.gif"]);BIONE.prevLoadImage(e+"lib/ligerUI/skins/Gray/images/win/",["dialogicon.gif"]);};BIONE.ajax=function(f,j){var i=f||{};var h=i.type||"get";var e=i.url;var g=i.async||"true";c.ajax({cache:false,async:g,url:e,dataType:"json",type:h,data:i.data,beforeSend:function(){BIONE.loading=true;if(i.beforeSend){i.beforeSend();}else{BIONE.showLoading(i.loading);}},complete:function(){BIONE.loading=false;if(i.complete){i.complete();}else{BIONE.hideLoading();}},success:j,error:function(l,k){BIONE.tip("发现系统错误 <BR>错误码："+l.status);}});};BIONE.getPageMenuNo=function(){var e=c("#MenuNo").val();if(!e){e=getQueryStringByName("MenuNo");}return e;};BIONE.createButton=function(m){var f=c.extend({appendTo:c("body")},m||{});if(f.operNo&&top.window["protectedResOperNo"]){if(c.inArray(f.operNo,top.window["protectedResOperNo"])!=-1){if(!top.window["authorizedResOperNo"]||c.inArray(f.operNo,top.window["authorizedResOperNo"])==-1){return;}}}var i=false;if(f.icon){i=true;}var g='<div class="l-btn';if(i){g=g+" l-btn-hasicon";}g+='"><div class="l-btn-l"></div><div class="l-btn-r"> </div> <span></span></div>';var h=c(g);if(f.icon){h.append('<div class="l-icon l-icon-'+f.icon+'"> </div> ');}if(f.width){h.width(f.width);}if(f.click){h.click(f.click);}if(f.text){c("span",h).html(f.text);}if(typeof(f.appendTo)=="string"){var e=30;var k=0;var l=0;var j=c(f.appendTo+" .l-btn").length;f.appendTo=c(f.appendTo);if(j!=0){l=f.appendTo.width();}if(i){k=10;}f.appendTo.width(l+parseInt(f.width)+e+k);}h.appendTo(f.appendTo);};BIONE.bulidFilterGroup=function(e){if(!e){return null;}var f={op:"and",rules:[]};c(":input",e).not(":submit, :reset, :image,:button, [disabled]").each(function(){if(!this.name){return;}if(c(this).val()==null||c(this).val()==""){return;}if(c(this).attr("field")==null||c(this).attr("field")==""){return;}var i=c(this).attr("ltype");var h=c(this).attr("ligerui"),g;if(h){g=JSON2.parse(h);}var l=c(this).attr("field");var m=c(this).attr("op")||"=";var j=c(this).attr("vt")||"string";var k=c(this).val();if(i=="select"&&g&&g.valueFieldID){k=c("#"+g.valueFieldID).val();name=g.valueFieldID;}f.rules.push({op:m,field:l,value:k,type:j});});return f;};BIONE.addSearchButtons=function(g,f,e){if(!g){return;}g=c(g);if(e){BIONE.createButton({appendTo:e,text:"搜索",icon:"search3",width:"50px",click:function(){var h=BIONE.bulidFilterGroup(g);if(h.rules.length){f.set("parms",{condition:JSON2.stringify(h)});f.set("newPage",1);}else{f.set("parms",{condition:""});f.set("newPage",1);}f.loadData();}});BIONE.createButton({appendTo:e,text:"重置",icon:"refresh2",width:"50px",click:function(){c(":input",g).not(":submit, :reset,:hidden,:image,:button, [disabled]").each(function(){c(this).val("");});c(":input[ltype=combobox]",g).each(function(){c(this).val("");});}});}};BIONE.setFormDefaultBtn=function(e,g){var f=[];if(e){f.push({text:"取消",onclick:e});}if(g){f.push({text:"保存",onclick:g});}BIONE.addFormButtons(f);};BIONE.addFormButtons=function(f){if(!f){return;}var e=c("div.form-bar");if(e.length==0){e=c('<div class="form-bar"><div class="form-bar-inner"></div></div>').appendTo("body");}if(!(f instanceof Array)){f=[f];}c(f).each(function(h,j){var g=c('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div> ');c("div.l-dialog-btn-inner:first",g).html(j.text||"BUTTON");if(j.onclick){g.bind("click",function(){j.onclick(j);});}if(j.width){g.width(j.width);}c("> div:first",e).append(g);});};BIONE.loadForm=function(f,e){e=e||{};function g(r){for(var h in r){var w=c("[name="+h+"]");if(w.is(":checkbox,:radio")){w[0].checked=r[h]?true:false;}else{if(w.is(":text")&&w.attr("ltype")=="date"){if(r[h]){var m=null;if(r[h].time){m=new Date(r[h].time);}else{var k;if(typeof r[h]=="string"&&r[h].indexOf("-")!=-1&&r[h].length>=10){k=new Date(new Number(r[h].substr(0,4)),new Number(r[h].substr(5,2))-1,new Number(r[h].substr(8,2)));}else{k=new Date(r[h]);}m=new Date(k);}var t=m.getFullYear();var s=((m.getMonth()+1)<10)?("0"+(m.getMonth()+1)):(m.getMonth()+1);var u=(m.getDate()<10)?("0"+m.getDate()):m.getDate();w.val(t+"-"+s+"-"+u);}}else{w.val(r[h]);}}}var v=c.ligerui.find(c.ligerui.controls.Input);for(var q=0,n=v.length;q<n;q++){var j=v[q];j.updateStyle();if(v[q] instanceof c.ligerui.controls.TextBox){j.checkValue();}}}BIONE.ajax(e,g);};BIONE.submitForm=function(f,g,e){if(!f){f=c("form:first");}if(f.valid()){f.ajaxSubmit({dataType:"json",success:function(){BIONE.hideLoading();g();},beforeSubmit:function(p,n,k){c(":checkbox,:radio",n).each(function(){if(!h(p,this.name)){p.push({name:this.name,type:this.type,value:this.checked});}});for(var m=0,j=p.length;m<j;m++){var q=p[m];if(q.type=="checkbox"||q.type=="radio"){q.value=c("[name="+q.name+"]",n)[0].checked?"true":"false";}}},beforeSend:function(j,i,k){BIONE.showLoading("正在保存数据中...");},complete:function(){},error:function(i){BIONE.hideLoading();BIONE.tip("发现系统错误 <BR>错误码："+i.status);}});}else{BIONE.showInvalid();}function h(n,k){for(var m=0,j=n.length;m<j;m++){var p=n[m];if(p.name==k){return true;}}return false;}};BIONE.showInvalid=function(e){e=e||BIONE.validator;if(!e){return;}var f='<div class="invalid">存在'+e.errorList.length+"个字段验证不通过，请检查!</div>";c.ligerDialog.error(f);};BIONE.validate=function(f,e){if(typeof(f)=="string"){f=c(f);}else{if(typeof(f)=="object"&&f.NodeType==1){f=c(f);}}e=c.extend({errorPlacement:function(g,h){if(h.hasClass("l-textarea")){h.addClass("l-textarea-invalid");}else{if(h.hasClass("l-text-field")){h.parent().addClass("l-text-invalid");}}var i=h.parents("li:first").next("li");i.find("div.l-exclamation").remove();c('<div class="l-exclamation" title="'+g.html()+'"></div>').appendTo(i).ligerTip();},success:function(g){var h=c("#"+g.attr("for"));var i=h.parents("li:first").next("li");if(h.hasClass("l-textarea")){h.removeClass("l-textarea-invalid");}else{if(h.hasClass("l-text-field")){h.parent().removeClass("l-text-invalid");}}i.find("div.l-exclamation").remove();c(".l-verify-tip").remove();},width:200},e||{});BIONE.validator=f.validate(e);return BIONE.validator;};BIONE.loadToolbar=function(j,k,h){if(!j.toolbarManager){return;}if(!k||!k.length){return;}var f=[];for(var g=0,e=k.length;g<e;g++){var m=k[g];if(m.operNo&&top.window["protectedResOperNo"]){if(c.inArray(m.operNo,top.window["protectedResOperNo"])!=-1){if(!top.window["authorizedResOperNo"]||c.inArray(m.operNo,top.window["authorizedResOperNo"])==-1){continue;}}}f[f.length]={click:m.click||h,text:m.text,icon:m.icon,id:m.operNo,menu:m.menu};f[f.length]={line:true};}j.toolbarManager.set("items",f);};BIONE.loadTreeToolbar=function(j,k,h){if(!j.treetoolbarManager){return;}if(!k||!k.length){return;}var f=[];for(var g=0,e=k.length;g<e;g++){var m=k[g];if(m.operNo&&top.window["protectedResOperNo"]){if(c.inArray(m.operNo,top.window["protectedResOperNo"])!=-1){if(!top.window["authorizedResOperNo"]||c.inArray(m.operNo,top.window["authorizedResOperNo"])==-1){continue;}}}f[f.length]={click:m.click||h,text:m.text,icon:m.icon,id:m.operNo,menu:m.menu};f[f.length]={line:true};}j.toolbarManager.set("items",f);};BIONE.setGridDoubleClick=function(e,g,f){f=f||toolbarBtnItemClick;if(!f){return;}e.bind("dblClickRow",function(i){var h=BIONE.findToolbarItem(e,g);if(!h){return;}e.select(i);f(h);});};BIONE.closeDialog=function(h,g){var e=parent||window;var f=e.jQuery.ligerui.get(h);f.close();if(g){e.BIONE.tip(g);}};BIONE.closeDialogAndReloadParent=function(i,f,h){var e=parent||window;var g=e.jQuery.ligerui.get(i);g.close();e.jQuery.ligerui.get(f).loadData();if(h){e.BIONE.tip(h);}};BIONE.closeIconDialog=function(g,h){var e=parent||window;var f=e.jQuery.ligerui.get(g);var i=e.jQuery.ligerui.get(f.options.comboxName);i._changeValue(h,h);f.close();};BIONE.commonOpenDialog=function b(k,g,h,e,f,i){var j=c.ligerui.get(g);if(j){c.ligerui.remove(g);}j=c.ligerDialog.open({height:e,width:h,url:f,name:g,id:g,title:k,comboxName:i,isResize:false,isDrag:false,isHidden:false});return j;};BIONE.commonOpenSmallDialog=function d(j,g,f){var h=600;var e=320;var i=c.ligerui.get(g);if(i){c.ligerui.remove(g);}i=c.ligerDialog.open({height:e,width:h,url:f,name:g,id:g,title:j,isResize:false,isDrag:false,isHidden:false});return i;};BIONE.commonOpenLargeDialog=function a(j,g,f){var h=800;var e=450;var i=c.ligerui.get(g);if(i){c.ligerui.remove(g);}i=c.ligerDialog.open({height:e,width:h,url:f,name:g,id:g,title:j,isResize:false,isDrag:false,isHidden:false});return i;};BIONE.commonOpenIconDialog=function a(k,g,f,i){var h=480;var e=350;var j=c.ligerui.get(g);if(j){c.ligerui.remove(g);}j=c.ligerDialog.open({height:e,width:h,url:f,name:g,id:g,title:k,isResize:false,isDrag:false,isHidden:false,comboxName:i});return j;};BIONE.refreshAsyncTreeNodes=function(g,h,i,e){if(g&&g.setting&&i!=null){if(e==null||e==""){e="refresh";}if(h==null||h==""){h="id";}var f=g.getNodeByParam(h,i,null);g.reAsyncChildNodes(f,e,false);}};BIONE.paramTransformer=function(h,f,i){var e="";var g="";if(i){g="paramTypeNo="+i+"&paramValue="+h;}else{g="paramValue="+h;}c.ajax({cache:false,async:false,url:f,dataType:"text",type:"post",data:g,success:function(j){e=j;}});return e;};BIONE.BIONETree=function(z,g){if(!c.fn.zTree||typeof c.fn.zTree=="undefined"||!z||typeof z=="undefined"){return null;}var w={dataType:"local",nodes:[],url:false,ajaxType:"json",method:"post",dataFilter:null,onceInit:false,commonParam:[],autoParam:[],keepParent:false,keepLeaf:false,idKey:"id",pIdKey:"upId",rootPIdKey:null,checkedKey:"checked",childrenKey:"children",nameKey:"text",tipKey:"",checkbox:false,chkStyle:"checkbox",radioType:"level",chkedEft_p:true,chkedEft_c:true,chkOffEft_p:true,chkOffEft_c:true,editEnable:false,removeTitle:"remove",showRemoveBtn:true,autoCancelSelected:true,selectedMulti:false,showTip:true,showIcon:true,showLine:true,beforeCheck:null,beforeClick:null,beforeRemove:null,onCheck:null,onClick:null,onRemove:null};var r=w;if(g&&typeof g=="object"){if(g.dataType&&typeof g.dataType!="undefine"&&(g.dataType=="local"||g.dataType=="server")){r.dataType=g.dataType;}if(g.nodes&&typeof g.nodes=="object"){if((g.nodes) instanceof Array){r.nodes=g.nodes;}}if(g.url&&typeof g.url!="undefined"){r.url=g.url;}if(g.ajaxType&&typeof g.ajaxType!="undefined"){r.ajaxType=g.ajaxType;}if(g.method&&typeof g.method!="undefined"){if((g.method).toLowerCase()=="get"||(g.method).toLowerCase()=="post"){r.method=(g.method).toLowerCase();}}if(g.onceInit&&typeof g.onceInit!="undefined"){r.onceInit=g.onceInit;}if(g.commonParam&&typeof g.commonParam!="undefined"){if(typeof g.commonParam=="object"){if(g.commonParam instanceof Array){var e=g.commonParam;var n={};var f=[];if(e.length>0&&e.length%2!=0){for(var y=0;y<e.length-1;y++){f.push(e[y]);}}else{f=e;}for(var v=0;v<f.length;v+=2){n[f[v]]=f[v+1];}r.commonParam=n;}else{r.commonParam=g.commonParam;}}}if(g.autoParam&&typeof g.autoParam=="object"&&g.autoParam instanceof Array){r.autoParam=g.autoParam;}if(g.keepParent&&typeof g.keepParent!="undefined"){r.keepParent=g.keepParent;}if(g.keepLeaf&&typeof g.keepLeaf!="undefined"){r.keepLeaf=g.keepLeaf;}if(g.idKey&&typeof g.idKey!="undefined"){r.idKey=g.idKey;}if(g.pIdKey&&typeof g.pIdKey!="undefined"){r.pIdKey=g.pIdKey;}if(g.rootPIdKey&&typeof g.rootPIdKey!="undefined"){r.rootPIdKey=g.rootPIdKey;}if(g.checkedKey&&typeof g.checkedKey!="undefined"){r.checkedKey=g.checkedKey;}if(g.childrenKey&&typeof g.childrenKey!="undefined"){r.childrenKey=g.childrenKey;}if(g.nameKey&&typeof g.nameKey!="undefined"){r.nameKey=g.nameKey;}if(g.tipKey&&typeof g.tipKey!="undefined"){r.tipKey=g.tipKey;}if(g.autoCancelSelected&&typeof g.autoCancelSelected!="undefined"){r.autoCancelSelected=g.autoCancelSelected;}if(g.selectedMulti&&typeof g.selectedMulti!="undefined"){r.selectedMulti=g.selectedMulti;}if(g.showTip&&(typeof g.showTip=="boolean"||typeof g.showTip=="function")){r.showTip=g.showTip;}if(g.showIcon&&(typeof g.showIcon=="boolean"||typeof g.showIcon=="function")){r.showIcon=g.showIcon;}if(g.showLine&&typeof g.showLine!="undefined"){r.showLine=g.showLine;}if(g.checkbox&&typeof g.checkbox=="boolean"){r.checkbox=g.checkbox;}if(g.chkStyle&&typeof g.chkStyle!="undefined"&&(g.chkStyle=="checkbox"||g.chkStyle=="radio")){r.chkStyle=g.chkStyle;}if(g.chkedEft_p&&typeof g.chkedEft_p=="boolean"){r.chkedEft_p=g.chkedEft_p;}if(g.chkedEft_c&&typeof g.chkedEft_c=="boolean"){r.chkedEft_c=g.chkedEft_c;}if(g.chkOffEft_p&&typeof g.chkOffEft_p=="boolean"){r.chkOffEft_p=g.chkOffEft_p;}if(g.chkOffEft_c&&typeof g.chkOffEft_c=="boolean"){r.chkOffEft_c=g.chkOffEft_c;}if(g.editEnable&&typeof g.editEnable=="boolean"){r.editEnable=g.editEnable;}if(g.removeTitle&&typeof g.removeTitle!="undefined"){r.removeTitle=g.removeTitle;}if(g.showRemoveBtn&&typeof g.showRemoveBtn!="undefined"){r.showRemoveBtn=g.showRemoveBtn;}if(g.beforeCheck&&typeof g.beforeCheck=="function"){r.beforeCheck=g.beforeCheck;}if(g.beforeClick&&typeof g.beforeClick=="function"){r.beforeClick=g.beforeClick;}if(g.beforeRemove&&typeof g.beforeRemove=="function"){r.beforeRemove=g.beforeRemove;}if(g.onCheck&&typeof g.onCheck=="function"){r.onCheck=g.onCheck;}if(g.onClick&&typeof g.onClick=="function"){r.onClick=g.onClick;}if(g.onRemove&&typeof g.onRemove=="function"){r.onRemove=g.onRemove;}}var s={};var u=[];var o={autoCancelSelected:r.autoCancelSelected,selectedMulti:r.selectedMulti,showLine:r.showLine,showTip:true,showIcon:true};if(r.showTip){if(typeof r.showTip=="function"){o.showTip=r.showTip;}else{if(typeof r.showTip=="boolean"){o.showTip=r.showTip;}}}if(r.showIcon){if(typeof r.showIcon=="function"){o.showIcon=r.showIcon;}}if(r.editEnable){var t={enable:true,removeTitle:r.removeTitle,showRemoveBtn:r.showRemoveBtn};if(r.showRemoveBtn){if(typeof r.showRemoveBtn=="function"){t.showRemoveBtn=r.showRemoveBtn;}}s.edit=t;}var A={keep:{leaf:r.keepLeaf,parent:r.keepParent},key:{checked:r.checkedKey,children:r.childrenKey,name:r.nameKey,title:r.tipKey},simpleData:{enable:true,idKey:r.idKey,pIdKey:r.pIdKey,rootPId:r.rootPIdKey}};if(r.checkbox){var x={enable:true,chkStyle:r.chkStyle,radioType:r.radioType};var h={"Y":"","N":""};var j="";if(r.chkedEft_p){j=j+"p";}if(r.chkedEft_c){j=j+"s";}var q="";if(r.chkOffEft_p){q=q+"p";}if(r.chkOffEft_c){q=q+"s";}h.Y=j;h.N=q;x.chkboxType=h;s.check=x;}var l={beforeCheck:null,beforeClick:null,beforeRemove:null,onCheck:null,onClick:null,onRemove:null};if(r.beforeCheck!=null&&typeof r.beforeCheck=="function"){l.beforeCheck=r.beforeCheck;}if(r.beforeClick!=null&&typeof r.beforeClick=="function"){l.beforeClick=r.beforeClick;}if(r.beforeRemove!=null&&typeof r.beforeRemove=="function"){l.beforeRemove=r.beforeRemove;}if(r.onCheck!=null&&typeof r.onCheck=="function"){l.onCheck=r.onCheck;}if(r.onClick!=null&&typeof r.onClick=="function"){l.onClick=r.onClick;}if(r.onRemove!=null&&typeof r.onRemove=="function"){l.onRemove=r.onRemove;}s.callback=l;if(r.dataType=="local"){u=r.nodes;}else{if(r.dataType=="server"&&r.url&&r.onceInit){var k={enable:false,dataType:r.ajaxType,type:r.method,url:r.url,otherParam:r.commonParam};s.async=k;c.ajax({cache:false,async:false,url:r.url,dataType:r.ajaxType,data:r.commonParam,type:r.method,success:function(p){if(p&&typeof p=="object"){if(p instanceof Array){for(var B=0;B<r.nodes.length;B++){u.push(r.nodes[B]);}for(var C=0;C<p.length;C++){u.push(p[C]);}}}},error:function(p,i){}});}else{if(r.dataType=="server"&&r.url&&!r.onceInit){A.simpleData.enable=false;var k={enable:true,dataType:r.ajaxType,type:r.method,url:r.url,otherParam:r.commonParam,autoParam:r.autoParam};s.async=k;}}}s.view=o;s.data=A;var m=c.fn.zTree.init(z,s,u);m.baseNodes=r.nodes;m["getTreeById"]=function(i){if(i!=null){return c.fn.zTree.getZTreeObj(i);}};if(r.dataType=="server"&&!r.onceInit&&r.url){m["refreshTree"]=function(p){var i=this;if(p){i.reAsyncChildNodes(p,"refresh");}else{i.reAsyncChildNodes(null,"refresh");}};}else{if(r.dataType=="server"&&r.url&&r.onceInit){m["refreshTree"]=function(){var i=this;i.removeAll();c.ajax({cache:false,async:false,url:i.setting.async.url,dataType:i.setting.async.ajaxType,data:i.setting.async.commonParam,type:i.setting.async.method,success:function(p){if(p&&typeof p=="object"){if(p instanceof Array){var B=i.baseNodes;for(var C=0;C<p.length;C++){B.push(p[C]);}i.addNodes(null,B);}}},error:function(B,p){}});};}}m["removeAll"]=function(){var F=this;var p=F.getNodes();var C=[];if(p!=null){for(var D=0;D<p.length;D++){C.push(p[D].tId);}for(var B=0;B<C.length;B++){var E=F.getNodeByParam("tId",C[B],null);if(E!=null){F.removeChildNodes(E);F.removeNode(E);}}}};return m;};})(jQuery);